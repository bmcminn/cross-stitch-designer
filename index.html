<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Cross Stitch Designer</title>
	<meta name="description" content="My official cross stitch design app, made with love <3 and built with P5.js">
	<meta name="author" content="Brandtley McMinn <https://github.com/bmcminn/cross-stitch-designer>">
	<meta name="viewport" content="width=device-width">
	<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" /> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/solid.min.css" />
	<link rel="stylesheet" href="assets/reset.css">
	<link rel="stylesheet" href="assets/app.css">
	<style type="text/css">
		body.no-js #app {
			display: none;
		}
	</style>

</head>
<body class="no-js">

	<noscript>
		This app requires JavaScript to work.
	</noscript>

	<main id="app">
		<vue-p5
			class="waffles"
			@setup="setup"
			@draw="draw"
			@keypressed="keypressed"
            @mousemoved="mousemoved"
			@windowresized="windowresized"
		></vue-p5>

		<div class="controls controls--sidebar">
            <section id="design-information">
    			<h1>{{ design.title }}</h1>

                <div>
                Count Size: {{ settings.columns }} x {{ settings.rows }}
                </div>

                <div>
                Finished Size: {{ design.widthInches|round }}" x {{ design.heightInches|round }}"
                </div>

                <div>
                Copyright &copy; {{ design.copyright|datetime('YYYY') }} {{ design.owner }}
                </div>
            </section>


            <details id="document-configuration">
                <summary>Document Information</summary>
    			<div>
    				<label for="design.title">Design Title</label>
    				<input type="text"
                        class="full-width"
    					id="design.title"
    					v-model="design.title"
    					@change="save()"
    				/>
    			</div>


                <div>
                    <label for="design.owner">Owner</label>
                    <input type="text"
                        class="full-width"
                        id="design.owner"
                        v-model="design.owner"
                        @change="save()"
                    />
                </div>


                <div>
                    <label for="design.copyright">Copyright</label>
                    <input type="date"
                        class="full-width"
                        id="design.copyright"
                        v-model="design.copyright"
                        @change="save()"
                    />
                </div>
            </details>

            <details id="document-setup">
                <summary>Document Setup</summary>
                <div class="flex">
                    <label for="settings.columns">Width</label>
                    <input type="number"
                        id="settings.columns"
                        v-model="settings.columns"
                        min="0"
                        max="100"
                        @change="adjustGrid()"
                    />
                </div>

    			<div class="flex">
    				<label for="settings.rows">Height</label>
    				<input type="number"
    					id="settings.rows"
    					v-model="settings.rows"
    					@change="adjustGrid()"
    					min="0"
    					max="100"
    				/>
    			</div>


                <div class="flex">
                    <label for="settings.aidaCount">AIDA Count</label>
                    <input id="settings.aidaCount"
                        @change="adjustGrid()"
                        type="number"
                        min="7"
                        max="28"
                        v-model="settings.aidaCount"
                    />
                </div>
            </details>


            <details id="ui-settings">
                <summary>UI Settings</summary>

                <div class="flex">
                    <label for="settings.tilesize">Zoom</label>
                    <input id="settings.tilesize"
                        @change="adjustGrid()"
                        type="number"
                        min="6"
                        max="25"
                        v-model="settings.tilesize"
                    />
                </div>


                <div>
                    <label for="settings.gridBackgroundColor">Background color</label>
                    <input id="settings.gridBackgroundColor"
                        @change="save()"
                        type="color"
                        v-model="settings.gridBackgroundColor"
                    />
                </div>

                <div>
                    <label for="settings.gridLineColor">Grid line color</label>
                    <input id="settings.gridLineColor"
                        @change="save()"
                        type="color"
                        v-model="settings.gridLineColor"
                    />
                </div>

                <div title="Show/hide the cursor location markers at edge of design grid">
                    <input type="checkbox"
                        id="settings.showCursorMarkers"
                        v-model="settings.showCursorMarkers"
                    />
                    <label for="settings.showCursorMarkers">Show cursor markers</label>
                </div>

                <div title="Show/hide the row and column numbers">
                    <input type="checkbox"
                        id="settings.showGridNumbers"
                        v-model="settings.showGridNumbers"
                    />
                    <label for="settings.showGridNumbers">Show row/column numbers</label>
                </div>

                <div title="Show/hide the design center cross">
                    <input type="checkbox"
                        id="settings.showCenterCross"
                        v-model="settings.showCenterCross"
                    />
                    <label for="settings.showCenterCross">Show design center marker</label>
                </div>
            </details>


			<details id="layers-panel" open>
                <summary>Layers</summary>


                <button @click="newLayer">
                    New layer <small class="fas fa-fw fa-plus"></small>
                </button>

    			<ul class="controls controls--layers">
    				<li
    					v-for="(layer, layerIndex) in layers"
    					:key="layerIndex"
    					@click="selectLayer(layerIndex)"
    					class="flex flex-row flex-center control--layer"
                        :selected="selectedLayer === layerIndex"
    				>

    					<input class="layer-color"
    						type="color"
    						v-model="layer.color"
    						@change="save()"
    						:style="{
    							'background-color': layer.color
    						}"
    					/>

    			      	<div class="flex-grow layer--name">
    			      		<!-- // TODO: figure out a clickaway strategy -->
    			      	  	<label v-show="layer.editingtitle == false"
    			      	  		class="full-width"
    			      	  		@dblclick="layer.editingtitle=true"
    			      	  	>{{ layer.title }}</label>

    				      	<input v-show="layer.editingtitle == true"
    				      		v-model="layer.title"
    				      		v-on:blur="layer.editingtitle=false; $emit('update'); save()"
    				      		@keyup.enter="layer.editingtitle=false; $emit('update'); save()"
    				      		@keyup.esc="layer.editingtitle=false; $emit('update'); save()"
    				      	/>
    			      	</div>

    			      	<!-- // TODO:  -->
    					<button @click="moveLayer(layerIndex, -1)"
    						:disabled="layerIndex === 0"
    					>
    						<span class="fas fa-fw fa-angle-up"></span>
    					</button>

    					<button @click="moveLayer(layerIndex, 1)"
    						:disabled="layerIndex === layers.length-1"
    					>
    						<span class="fas fa-fw fa-angle-down"></span>
    					</button>

                        <button @click="deleteLayer(layerIndex)">
                            <span class="fas fa-fw fa-trash"></span>
                        </button>
    				</li>
    			</ul>
            </details>

            <hr class="my-2">

            <p class="text-center">
                {{ app.name }} v{{ app.version }}<br>
                &copy; {{ null|datetime('YYYY') }} <a href="https://github.com/bmcminn">bmcminn</a><br>
                <a href="https://github.com/bmcminn/cross-stitch-designer">Github</a> |
                <a href="https://github.com/bmcminn/cross-stitch-designer/blob/master/README.md">Docs</a> |
                <a href="https://github.com/bmcminn/cross-stitch-designer/issues">Issues</a>
            </p>
		</div>
	</main>


	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js" integrity="sha512-WIklPM6qPCIp6d3fSSr90j+1unQHUOoWDS4sdTiR8gxUTnyZ8S2Mr8e10sKKJ/bhJgpAa/qG068RDkg6fIlNFA==" crossorigin="anonymous"></script> -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->
	<!-- <script src="https://unpkg.com/lz-string@1.4.4/libs/lz-string.min.js"></script> -->
    <script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
	<!-- <script src="https://unpkg.com/lzwcompress@0.5.22/lzwCompress.js"></script> -->
	<script src="https://unpkg.com/vue@2.6.12/dist/vue.min.js"></script>
	<script src="https://unpkg.com/vue-p5"></script>
	<script src="assets/app.js"></script>

</body>
</html>
