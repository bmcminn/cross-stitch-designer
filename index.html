<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Cross Stitch Designer</title>
	<meta name="description" content="My official cross stitch design app, made with love <3 and built with P5.js">
	<meta name="author" content="Brandtley McMinn <https://github.com/bmcminn/cross-stitch-designer>">
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />
	<link rel="stylesheet" href="assets/reset.css">
	<link rel="stylesheet" href="assets/app.css">
	<style type="text/css">
		body.no-js #app {
			display: none;
		}
	</style>

</head>
<body class="no-js">

	<noscript>
		This app requires JavaScript to work.
	</noscript>

	<main id="app">
		<vue-p5
			class="waffles"
			@setup="setup"
			@draw="draw"
			@keypressed="keypressed"
			@windowresized="windowresized"
		></vue-p5>

		<div class="controls controls--sidebar">
            <section id="document-setup">
    			<h3>Document Setup</h3>

    			<div class="flex">
    				<label for="document-width">Width</label>
    				<input type="number"
    					name="document-width"
    					v-model="columns"
    					min="0"
    					max="40"
    					@change="adjustGrid()"
    				/>
    			</div>

    			<div class="flex">
    				<label for="document-height">Height</label>
    				<input type="number"
    					name="document-height"
    					v-model="rows"
    					@change="adjustGrid()"
    					min="0"
    					max="40"
    				/>
    			</div>
            </section>

			<section id="layers-panel">
                <h3>
    				Layers
    				<button @click="newLayer">
    					<small class="fas fa-fw fa-plus"></small>
    				</button>
    			</h3>

    			<ul class="controls controls--layers">
    				<li
    					v-for="(layer, layerIndex) in layers"
    					:key="layerIndex"
    					@click="selectLayer(layerIndex)"
    					class="flex flex-row flex-center control--layer"
                        :selected="selectedLayer === layerIndex"
    				>

    					<input class="layer-color"
    						type="color"
    						v-model="layer.color"
    						@change="save()"
    						:style="{
    							'background-color': layer.color
    						}"
    					/>

    			      	<div class="flex-grow layer--name">
    			      		<!-- // TODO: figure out a clickaway strategy -->
    			      	  	<label v-show="layer.editingtitle == false"
    			      	  		class="full-width"
    			      	  		@dblclick="layer.editingtitle=true"
    			      	  	>{{ layer.title }}</label>

    				      	<input v-show="layer.editingtitle == true"
    				      		v-model="layer.title"
    				      		v-on:blur="layer.editingtitle=false; $emit('update'); save()"
    				      		@keyup.enter="layer.editingtitle=false; $emit('update'); save()"
    				      		@keyup.esc="layer.editingtitle=false; $emit('update'); save()"
    				      	/>
    			      	</div>

    			      	<!-- // TODO:  -->
    					<button @click="moveLayer(layerIndex, -1)"
    						:disabled="layerIndex === 0"
    					>
    						<span class="fas fa-fw fa-angle-up"></span>
    					</button>

    					<button @click="moveLayer(layerIndex, 1)"
    						:disabled="layerIndex === layers.length-1"
    					>
    						<span class="fas fa-fw fa-angle-down"></span>
    					</button>

                        <button @click="deleteLayer(layerIndex)">
                            <span class="fas fa-fw fa-trash"></span>
                        </button>
    				</li>
    			</ul>
            </section>
		</div>
	</main>


	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js" integrity="sha512-WIklPM6qPCIp6d3fSSr90j+1unQHUOoWDS4sdTiR8gxUTnyZ8S2Mr8e10sKKJ/bhJgpAa/qG068RDkg6fIlNFA==" crossorigin="anonymous"></script> -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->
	<!-- <script src="https://unpkg.com/lz-string@1.4.4/libs/lz-string.min.js"></script> -->
	<script src="https://unpkg.com/lzwcompress@0.5.22/lzwCompress.js"></script>
	<script src="https://unpkg.com/vue"></script>
	<script src="https://unpkg.com/vue-p5"></script>
	<script src="assets/app.js"></script>

</body>
</html>
